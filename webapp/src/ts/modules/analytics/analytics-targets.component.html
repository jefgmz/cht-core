<div class="page scrolling">
  @if (targetsDisabled) {
    <div class="item-content empty-selection">
      <div>{{ 'targets.disabled' | translate }}</div>
    </div>
  }

  @if (!targetsDisabled && loading) {
    <div class="item-content empty-selection">
      <div><div class="loader"></div></div>
    </div>
  }

  @if (!targetsDisabled && !loading && !targets?.length && !errorStack) {
    <div class="item-content empty-selection">
      <div>{{ 'targets.no_targets' | translate }}</div>
    </div>
  }

  @if (!targetsDisabled && !loading && !!errorStack) {
    <error-log class="targets" [errorStack]="errorStack" [errorFor]="'targets'"></error-log>
  }

  @if (!targetsDisabled && !loading && targets?.length && !errorStack) {
    <div class="targets">
      @for (target of targets; track target) {
        <div class="target"
          [ngClass]="{ 'has-goal': target.goal >= 0, 'goal-met': (target.value?.pass >= target.goal) || (target.value?.percent >= target.goal) }"
          attr.test-target-id="{{ target.id }}">
          <div class="body">
            @if (target.type === 'percent') {
              <mm-analytics-targets-progress
                [target]="target" [value]="target.value" [direction]="direction"
                [aggregate]="false">
              </mm-analytics-targets-progress>
            }
            @if (target.type !== 'percent') {
              <div class="count">
                @if (target.goal >= 0) {
                  <div class="goal">
                    <p>{{ 'analytics.target.monthly_goal' | translate }} {{ target.goal | localizeNumber }}</p>
                  </div>
                }
                <div class="number">{{ target.value?.pass | localizeNumber }}</div>
              </div>
            }
          </div>
          <div class="heading">
            <div class="icon" [innerHTML]="target.icon | resourceIcon"></div>
            <div class="title">
              @if (target.translation_key) {
                <h2>{{ target.translation_key | translate }}</h2>
              }
              @if (!target.translation_key) {
                <h2>{{ target.name | translateFrom }}</h2>
              }
              @if (target.subtitle_translation_key) {
                <p>{{ target.subtitle_translation_key | translate }}</p>
              }
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>
